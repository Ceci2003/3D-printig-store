---
import { getEntry } from 'astro:content';

let settings = null;
try {
  settings = (await getEntry('site', 'settings')).data;
} catch (e) {
  // Settings not found, use defaults
}
const phone = settings?.contactPhone || '';
const email = settings?.contactEmail || '';
const viber = settings?.viberNumber || phone;
---

<div class="fixed bottom-4 right-4 z-50 flex flex-col gap-2" aria-label="Бързи действия">
  <!-- Call -->
  <a
    href={`tel:${phone}`}
    class="bg-green-600 text-white p-3 rounded-full shadow-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition"
    aria-label="Обади се"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
    </svg>
  </a>

  <!-- Email -->
  <a
    href={`mailto:${email}`}
    class="bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition"
    aria-label="Изпрати имейл"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
    </svg>
  </a>

  <!-- Viber -->
  <a
    href={`viber://chat?number=${viber.replace(/[^0-9]/g, '')}`}
    class="bg-purple-600 text-white p-3 rounded-full shadow-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition"
    aria-label="Отвори Viber чат"
  >
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
      <path d="M13.066 0C8.197 0 4.34 3.857 4.34 8.726c0 2.409 1.01 4.574 2.633 6.13L4.276 21.33l6.533-2.636c1.6.87 3.418 1.38 5.257 1.38 4.869 0 8.726-3.857 8.726-8.726C24.592 3.857 20.735 0 15.866 0h-2.8zm.28 19.11c-1.276 0-2.52-.346-3.6-1.002l-.256-.152-2.652 1.07.998-2.58-.17-.28c-1.13-1.87-1.73-4.04-1.73-6.33 0-3.94 3.207-7.147 7.147-7.147h2.8c3.94 0 7.147 3.207 7.147 7.147 0 3.94-3.207 7.147-7.147 7.147-.88 0-1.74-.16-2.547-.456z"/>
      <path d="M16.13 11.203c-.24-.12-1.42-.7-1.64-.78-.22-.08-.38-.12-.54.12-.16.24-.63.78-.77.94-.14.16-.28.18-.52.06-.24-.12-1.01-.37-1.93-1.18-.71-.64-1.19-1.43-1.33-1.67-.14-.24-.01-.37.11-.49.11-.11.24-.28.36-.42.12-.14.16-.24.24-.4.08-.16.04-.3-.02-.42-.06-.12-.54-1.31-.74-1.79-.2-.48-.4-.42-.54-.43-.14-.01-.3-.01-.46-.01-.16 0-.4.06-.61.3-.21.24-.8.78-.8 1.9 0 1.12.82 2.2.93 2.35.12.15 1.6 2.44 3.87 3.42.54.23.96.37 1.29.47.54.17 1.03.15 1.42.09.43-.07 1.42-.58 1.62-1.14.2-.56.2-1.04.14-1.14-.06-.1-.22-.16-.46-.28z"/>
    </svg>
  </a>
</div>

<style>
  @media (max-width: 640px) {
    .fixed {
      bottom: 1rem;
      right: 1rem;
    }
    .fixed a {
      padding: 0.75rem;
    }
    .fixed svg {
      width: 1.25rem;
      height: 1.25rem;
    }
  }
</style>

